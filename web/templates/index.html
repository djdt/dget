<!doctype html>

{% extends "layout.html" %}
{% block head %}
    <script src="{{ url_for('static', filename='script.js') }}"></script>
{% endblock %}

{% block content %}
<div class="card" id="input">
    <h3>Input</h3>
    <form action="/calculate" method="post", enctype="multipart/form-data">
        <ul>
            <li>
                <label for="formula"> Formula: </label>
                <input type="text" id="formula" name="formula">
            </li>
            <li>
                <label for="adduct"> Adduct: </label>
                <div class="combobox">
                    <input name="adduct" id="adduct" value="[M+H]+">
                    <select onchange="this.previousElementSibling.value=this.value">
                        <option value=""></option>
                        {% for adduct in adducts %}
                        <option value="{{ adduct }}">{{ adduct }}</option>
                        {% endfor %}
                    </select>
                </div>
            </li>
            <li>
                <label for="file"> Upload MS data: </label>
                <input type="file" id="upload" name="upload">
                <script>
                    $("#upload").on("change", function(e) {
                        reader = new FileReader();
                        reader.onload = function () {
                           lines = reader.result.split("\n"); 
                            $.ajax({
                                url: "/guess_inputs",
                                type: "POST",
                                data: {lines: lines.slice(0, 20)},
                            });
                        }
                        file = e.target.files[0];
                        if (file) {
                            reader.readAsText(file);
                        }
                    });
                </script>
            </li>
            <li>
                <fieldset>
                    <legend>MS data options:</legend>
                    <label for="delimiter"> Delimiter: </label>
                    <select name="delimiter" id="delimiter">
                        {% for name, delim in delimiters.items() %}
                        <option value="{{ delim  }}">{{ name }}</option>
                        {% endfor %}
                    </select>
                    <br>
                    <label for="skiprows"> Skip rows: </label>
                    <input type="number", id="skiprows", name="skiprows", min="0", value="0">
                    <br>
                    <label for="masscol"> Mass column: </label>
                    <input type="number", id="masscol", name="masscol", min="1", value="1">
                    <br>
                    <label for="signalcol"> Signal column: </label>
                    <input type="number", id="signalcol", name="signalcol", min="1", value="2">
                </fieldset>
            </li>
            <li>
                <label class="checklabel" for="align"> Re-align MS data: </label>
                <input type="checkbox" id="align">
            </li>
            <li>
                <label class="checklabel" for="baseline"> Subtract MS basline: </label>
                <input type="checkbox" id="baseline">
            </li>
            <li>
                <button type="submit">Get D</button>
            </li>
        </ul>
    <!-- <br><br> -->
    </form>
</div>
<div class="card">
    Text
</div>
<div class="card">
    Text
</div>
{% endblock %}
